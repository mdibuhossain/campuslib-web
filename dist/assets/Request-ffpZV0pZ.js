import{r as d,R as w,p as f,j as t,P as K,n as V,t as z,G as C,q as J,v as S,w as X,x as L,y as Z}from"./index-wJGs2Dyv.js";import{u as $}from"./useAuth--PT8AQeI.js";import{u as ee}from"./useUtility-W3X80BJq.js";import{M as o,T as j,C as te,s as se,L as ae}from"./semesterList-XQ77hMun.js";import{B as u}from"./Box-7W4jJ3S5.js";import{G as n}from"./Grid-_DVyh2K7.js";import{T as ie}from"./Typography-GrtS7GM0.js";import{F as y,I as v,S as _,T as m}from"./TextField-Gxn5YIJd.js";import{L as le}from"./LoadingButton--hEwXqsf.js";import{B as oe}from"./Button-RQuI1RMD.js";import"./createSvgIcon-yjtepLD4.js";import"./isHostComponent-J57mIJhM.js";import"./List-5thjIYPv.js";import"./useSlotProps-XBDy4d6o.js";import"./interopRequireDefault-o0esyPcv.js";import"./createBox-E7Kn1Nho.js";import"./extendSxProp-GDan9hWr.js";import"./InputBase-UyuBnhxi.js";import"./utils-oO2cq3IH.js";import"./Paper-o1fpeHOc.js";import"./CircularProgress-VWTOl8-H.js";const qe=()=>{const{user:s,token:b}=$(),{getDepartments:q,deptLoading:B}=ee(),[h,T]=d.useState(!1),[D,k]=d.useState(!1),[O,Q]=d.useState(""),E={book_name:"",author:"",edition:"",download_link:"",categories:"",sub_categories:"",semester:[],status:!1,added_by:s==null?void 0:s.email},[a,W]=w.useState(E),[I,U]=w.useState([]);d.useEffect(()=>{const e=()=>{s!=null&&s.email||T(!h)};let i=setInterval(()=>{e()},500);return()=>clearInterval(i)},[h,s]);const R=e=>{const{target:{value:i}}=e;U(i),l(e)},l=e=>{W({...a,[e.target.name]:e.target.name==="categories"?e.target.value.trim().toLowerCase():e.target.name==="semester"?e.target.value:e.target.value.trim(),added_by:s==null?void 0:s.email})},A=e=>{e.target.value.trim().toLowerCase()==="others"?k(!0):(l(e),k(!1)),Q(e.target.value.trim().toLowerCase())},g=(e,i)=>[...e,i],[N,{data:c,loading:P}]=f(J,{update(e,{data:{addBook:i}}){const{getBooks:r}=e.readQuery({query:C});e.writeQuery({query:C,data:{getBooks:g(r,i)}})}}),[F,{data:p,loading:G}]=f(X,{update(e,{data:{addQuestion:i}}){const{getQuestions:r}=e.readQuery({query:S});e.writeQuery({query:S,data:{getQuestions:g(r,i)}})}}),[M,{data:x,loading:Y}]=f(Z,{update(e,{data:{addSyllabus:i}}){const{getAllSyllabus:r}=e.readQuery({query:L});e.writeQuery({query:L,data:{getAllSyllabus:g(r,i)}})}});d.useEffect(()=>{(c!=null&&c.addBook||p!=null&&p.addQuestion||x!=null&&x.addSyllabus)&&alert("Request submit successfully")},[c,p,x]);const H=e=>{e.preventDefault(),(a==null?void 0:a.sub_categories)==="book"?N({variables:{...a,token:b}}):(a==null?void 0:a.sub_categories)==="question"?F({variables:{...a,token:b}}):(a==null?void 0:a.sub_categories)==="syllabus"&&M({variables:{...a,token:b}}),e.target.reset()};return t.jsx(K,{children:t.jsx(u,{sx:{mt:8},children:t.jsxs(n,{container:!0,sx:{alignItems:"center"},children:[t.jsx(n,{item:!0,md:6,children:t.jsx(u,{sx:{display:{md:"block",xs:"none"}},children:t.jsx("img",{style:{width:"72%",margin:"auto"},src:"assets/images/request_banner.webp",alt:"request banner"})})}),t.jsxs(n,{item:!0,md:6,sx:{m:"auto"},children:[t.jsxs(u,{sx:{fontWeight:600,textAlign:"center",mb:4},children:[t.jsx(ie,{variant:"h5",sx:{fontWeight:600},children:"UPLOAD YOUR RESOURCE"}),!(s!=null&&s.email)&&t.jsx(V,{to:"/login",style:{color:h?"powderblue":"limegreen",textDecoration:"underline"},children:"→ require sign-in ←"})]}),t.jsx(u,{sx:{maxWidth:"450px",m:{md:"auto",xs:2},p:5,bgcolor:"white",borderRadius:2,boxShadow:"0.65px 1.75px 10px rgb(0, 0, 0, 0.3)"},children:t.jsxs("form",{onSubmit:H,children:[t.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[t.jsx(v,{id:"demo-simple-select-label",children:"Category"}),t.jsxs(_,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"sub_categories",value:a==null?void 0:a.sub_categories,label:"Category",onChange:l,required:!0,disabled:!(s!=null&&s.email),children:[t.jsx(o,{value:"syllabus",children:"Syllabus"}),t.jsx(o,{value:"book",children:"Book"}),t.jsx(o,{value:"question",children:"Question"})]})]}),t.jsx(m,{sx:{mb:2},id:"outlined-basic",label:"Title",name:"book_name",variant:"outlined",onChange:l,fullWidth:!0,required:!0,disabled:!(s!=null&&s.email)}),(a==null?void 0:a.sub_categories)==="book"&&t.jsxs(n,{container:!0,spacing:{md:2},sx:{transition:"0.5s ease-in-out"},children:[t.jsx(n,{item:!0,md:8,xs:12,sx:{transition:"0.5s ease-in-out"},children:t.jsx(m,{sx:{mb:2},id:"outlined-basic",label:"Author",name:"author",variant:"outlined",onChange:l,fullWidth:!0,disabled:!(s!=null&&s.email)})}),t.jsx(n,{item:!0,md:4,xs:12,sx:{transition:"0.5s ease-in-out"},children:t.jsx(m,{sx:{mb:2},id:"outlined-basic",label:"Edition",name:"edition",variant:"outlined",type:"number",onChange:l,fullWidth:!0,disabled:!(s!=null&&s.email)})})]}),t.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[t.jsx(v,{id:"department-selection",children:"Department"}),t.jsxs(_,{labelId:"department-selection",id:"department-selection",value:O,label:"Department",name:"categories",onChange:A,required:!0,disabled:!(s!=null&&s.email),children:[!B&&q.map((e,i)=>e&&t.jsx(o,{value:e,children:t.jsx(j,{title:z[e]||"",placement:"top-start",arrow:!0,children:t.jsx("div",{className:"w-full",children:e.toUpperCase()})})},i)),t.jsx(o,{value:"others",sx:{bgcolor:"orange",":hover":{bgcolor:"skyblue"}},children:t.jsx(j,{title:"If not sure.",placement:"top-start",arrow:!0,children:t.jsx("div",{className:"w-full",children:"OTHERS"})})})]})]}),D?t.jsx(m,{sx:{mb:2},id:"outlined-basic",label:"Unknown Department Name",name:"categories",variant:"outlined",onChange:l,fullWidth:!0,required:!0,disabled:!(s!=null&&s.email)}):null,(a==null?void 0:a.sub_categories)==="book"&&t.jsx(j,{title:"only select if applicable",placement:"top-end",arrow:!0,children:t.jsxs(y,{fullWidth:!0,sx:{mb:2},children:[t.jsx(v,{htmlFor:"semester-select",children:"Semester"}),t.jsx(_,{value:I??[],multiple:!0,id:"semester-select",label:"Semester",name:"semester",onChange:R,renderValue:e=>t.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(i=>t.jsx(te,{label:i},i))}),children:se.map(e=>e!=null&&e.title?t.jsx(ae,{sx:{fontWeight:"700"},children:e.title},e.title):t.jsx(o,{value:e,sx:{ml:1},children:e},e))})]})}),t.jsx(m,{sx:{mb:2},id:"outlined-basic",label:"Download link",name:"download_link",variant:"outlined",onChange:l,fullWidth:!0,required:!0,disabled:!(s!=null&&s.email)}),Y||G||P?t.jsx(le,{sx:{width:"100%"},loading:!0,variant:"contained",children:"Loading"}):t.jsx(oe,{type:"submit",sx:{width:"100%"},variant:"contained",disabled:!(a.sub_categories&&a.book_name&&a.categories&&a.download_link),children:"UPLOAD"})]})})]})]})})})};export{qe as default};
